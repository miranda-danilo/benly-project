<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Text to Speech Ingl√©s</title>
</head>
<body style="display: flex; background-color: plum; justify-content: center; align-items: center; min-height: 100dvh; flex-direction: column; font-family: Arial, sans-serif; gap: 1rem;">

<p style="font-weight: bold; font-size: 1.2rem;">Bienvenidos!</p>
<h2>Hola Amber üòÅ</h2>
<img src="https://cdn.prod.website-files.com/5fdb2fcbe8cb905cd95d758f/6780aa0e17a09012b62ee2f4_Karla%20Bustillos.png" alt="" style="width: 200px; height: 200px; border-radius: 50%;">
<h2>Hola Daniel üòÅ</h2>
<img src="https://scontent.cdninstagram.com/v/t51.75761-15/504406163_18068382508996950_3319617879960617085_n.webp?_nc_cat=110&ig_cache_key=MzY1MDcyNDg2MzU1OTQ0OTM4OA%3D%3D.3-ccb7-5&ccb=7-5&_nc_sid=58cdad&efg=eyJ2ZW5jb2RlX3RhZyI6InhwaWRzLjE0NDB4MTgwMS5zZHIuQzMifQ%3D%3D&_nc_ohc=BS_dc4StDAUQ7kNvwGPDwQU&_nc_oc=AdkXTTKCy34deVB7MM8o1DOQn498tQdVmAN7dk3lYm-SeKbMVZfoqA0gT5_nVEsnQk8&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.cdninstagram.com&_nc_gid=7ljAL0ie6_IyM8GiQ6hdsQ&oh=00_Afmq47pV6tuGZJjf9NUT7CcBMm0n6hT2GgL2bYlD-dAyvQ&oe=693B92B8" alt="" style="width: 200px; height: 200px; border-radius: 50%;">

<input style="background-color: aliceblue; padding: 0.4rem 0.8rem; width: 40%;" type="text" id="textInput" placeholder="Escribe algo en ingl√©s" >
<select style="padding: 1rem;" id="voiceSelect"></select>
<button style="padding: 0.4rem 0.8rem; background-color: rgb(255, 98, 124); color: white; font-size: 1.25rem; font-style: italic; font-weight: bold;" id="testVoice">üîä Probar voz</button>

<script>
let voicesLoaded = false;

// ============================================================
// Cargar voces disponibles (wake-up para m√≥viles)
// ============================================================
async function loadVoicesWithFallback() {
    return new Promise(resolve => {
        let voices = speechSynthesis.getVoices();
        if (voices.length) {
            voicesLoaded = true;
            return resolve(voices);
        }

        // Forzar wake-up del motor
        const dummy = new SpeechSynthesisUtterance(" ");
        speechSynthesis.speak(dummy);

        speechSynthesis.onvoiceschanged = () => {
            voices = speechSynthesis.getVoices();
            voicesLoaded = true;
            resolve(voices);
        };

        // Timeout de seguridad
        setTimeout(() => {
            voices = speechSynthesis.getVoices();
            voicesLoaded = true;
            resolve(voices);
        }, 2000);
    });
}

// ============================================================
// Llenar selector con todas las voces en ingl√©s (en*)
// ============================================================
async function populateVoiceSelector() {
    const select = document.getElementById("voiceSelect");
    select.innerHTML = '';

    const voices = await loadVoicesWithFallback();
    const englishVoices = voices.filter(v => v.lang.startsWith("en")); // todas las voces en ingl√©s

    englishVoices.forEach((voice, index) => {
        const option = document.createElement("option");
        option.value = voice.name; 
        option.textContent = `${index + 1}. ${voice.name} (${voice.lang})`;
        select.appendChild(option);
    });

    // Seleccionar autom√°ticamente la primera voz
    if (englishVoices.length > 0) select.value = englishVoices[0].name;

    console.log("Voces ingles cargadas:", englishVoices.map(v => `${v.name} (${v.lang})`));
}

// ============================================================
// Reproducir texto con voz seleccionada
// ============================================================
async function speakWithSelectedVoice() {
    if (!voicesLoaded) await populateVoiceSelector();

    const select = document.getElementById("voiceSelect");
    const textInput = document.getElementById("textInput");
    const text = textInput.value.trim() || "Hello, this is a test.";

    const voices = speechSynthesis.getVoices();
    const selectedVoice = voices.find(v => v.name === select.value);

    if (!selectedVoice) {
        alert("La voz seleccionada no est√° disponible. Intenta otra.");
        return;
    }

    const utterance = new SpeechSynthesisUtterance(text);
    utterance.voice = selectedVoice;
    utterance.rate = 1;   // puedes ajustar
    utterance.pitch = 1;  // puedes ajustar
    utterance.volume = 1;

    speechSynthesis.cancel();
    speechSynthesis.speak(utterance);

    console.log("Reproduciendo voz:", selectedVoice.name, selectedVoice.lang);
}

// ============================================================
// Evento bot√≥n
// ============================================================
document.getElementById("testVoice").addEventListener("click", speakWithSelectedVoice);

// Inicializar selector al cargar p√°gina
populateVoiceSelector();
</script>
</body>
</html>
